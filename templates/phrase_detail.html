{% extends "base.html" %}

{% block title %}Phrase Details - Moleboheng AI{% endblock %}

{% block content %}
<div class="container mt-5">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('categories') }}">Categories</a></li>
            <li class="breadcrumb-item"><a href="#" id="category-link">Category</a></li>
            <li class="breadcrumb-item active" id="phrase-name">Phrase</li>
        </ol>
    </nav>
    
    <div class="card" id="phrase-detail">
        <div class="card-body">
            <h1 id="sesotho-phrase" class="card-title text-center mb-4">Loading...</h1>
            
            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">English Translation</div>
                        <div class="card-body">
                            <p id="english-translation" class="card-text">Loading...</p>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">Pronunciation</div>
                        <div class="card-body">
                            <p id="pronunciation" class="card-text">Loading...</p>
                            <button class="btn btn-primary mt-2" onclick="speakPhrase()">ðŸ”Š Listen</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-4">
                <div class="card">
                    <div class="card-header">Usage Examples</div>
                    <div class="card-body">
                        <ul id="examples" class="list-unstyled">
                            <li>Loading examples...</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const phraseId = '{{ phrase_id }}';
    
    function speakPhrase() {
        const phrase = document.getElementById('sesotho-phrase').textContent;
        if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance(phrase);
            utterance.lang = 'st-ZA';
            window.speechSynthesis.speak(utterance);
        }
    }
    
    document.addEventListener('DOMContentLoaded', function() {
        fetch('/api/phrases')
            .then(response => response.json())
            .then(phrases => {
                const phrase = phrases.find(p => p.id === parseInt(phraseId));
                
                if (!phrase) {
                    document.getElementById('phrase-detail').innerHTML = '<h2>Phrase not found</h2>';
                    return;
                }
                
                document.getElementById('sesotho-phrase').textContent = phrase.sesotho;
                document.getElementById('english-translation').textContent = phrase.english;
                document.getElementById('pronunciation').textContent = phrase.pronunciation || 'Not available';
                
                const categoryLink = document.getElementById('category-link');
                categoryLink.textContent = phrase.category;
                categoryLink.href = `/category/${phrase.category}`;
                
                document.getElementById('phrase-name').textContent = phrase.sesotho;
                
                // Load examples if available
                if (phrase.examples && phrase.examples.length > 0) {
                    const examplesList = document.getElementById('examples');
                    examplesList.innerHTML = '';
                    phrase.examples.forEach(example => {
                        const li = document.createElement('li');
                        li.className = 'mb-2';
                        li.innerHTML = `<strong>${example.sesotho}</strong><br><small>${example.english}</small>`;
                        examplesList.appendChild(li);
                    });
                }
            });
    });
</script>
{% endblock %}
